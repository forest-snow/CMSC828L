/cliphomes/myuan/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
/cliphomes/myuan/anaconda3/lib/python3.6/site-packages/sklearn/utils/validation.py:475: DataConversionWarning: Data with input dtype uint8 was converted to float64 by MinMaxScaler.
  warnings.warn(msg, DataConversionWarning)
Epoch 5 train_acc: 0.8483831525273811, test_acc: 0.8485132287520487
Epoch 10 train_acc: 0.860037982257603, test_acc: 0.8521553630427431
Epoch 15 train_acc: 0.8761414188714587, test_acc: 0.8598818907880018
Epoch 20 train_acc: 0.8925310231795832, test_acc: 0.8620151408725513
Epoch 25 train_acc: 0.9034834412965999, test_acc: 0.8660995343271157
Epoch 30 train_acc: 0.909518978121179, test_acc: 0.8660475038372486
Epoch 35 train_acc: 0.9194828169307214, test_acc: 0.863419964098962
Epoch 40 train_acc: 0.9263248263482401, test_acc: 0.8654491532037775
Epoch 45 train_acc: 0.930929524701475, test_acc: 0.863914253752699
Epoch 50 train_acc: 0.9383178542625978, test_acc: 0.8627435677306902
Epoch 55 train_acc: 0.9415177293894222, test_acc: 0.8691953484742059
Epoch 60 train_acc: 0.9419599885532922, test_acc: 0.8688571502900699
Epoch 65 train_acc: 0.9487499674809439, test_acc: 0.8719789796820937
Epoch 70 train_acc: 0.949244257134681, test_acc: 0.8701579125367466
Epoch 75 train_acc: 0.9526002237311064, test_acc: 0.8739561382970421
Epoch 80 train_acc: 0.9526262389760399, test_acc: 0.8730456047243684
Epoch 85 train_acc: 0.956060251307266, test_acc: 0.8674263118187258
Epoch 90 train_acc: 0.9591040349644891, test_acc: 0.8708343089050183
Epoch 95 train_acc: 0.9568146934103384, test_acc: 0.8689091807799371
Epoch 100 train_acc: 0.9608990868649029, test_acc: 0.8762194646062592
Epoch 105 train_acc: 0.9609511173547699, test_acc: 0.8723692083560967
Epoch 110 train_acc: 0.9613153307838394, test_acc: 0.8757511901974557
Epoch 115 train_acc: 0.9625380472957152, test_acc: 0.8771560134238664
Epoch 120 train_acc: 0.9627981997450507, test_acc: 0.8746325346653139
Epoch 125 train_acc: 0.96272015401025, test_acc: 0.8708863393948854
Epoch 130 train_acc: 0.9649574650745337, test_acc: 0.8742683212362444
Epoch 135 train_acc: 0.9641509924815942, test_acc: 0.8741382450115768
Epoch 140 train_acc: 0.9639688857670595, test_acc: 0.8752569005437186
Epoch 145 train_acc: 0.9661021358516091, test_acc: 0.8781966232212076
Epoch 150 train_acc: 0.964775358359999, test_acc: 0.8774161658732017
Epoch 155 train_acc: 0.9655818309529384, test_acc: 0.8736699706027732
Epoch 160 train_acc: 0.9669606389344155, test_acc: 0.8756211139727881
Epoch 165 train_acc: 0.9665704102604126, test_acc: 0.8758812664221234
Epoch 170 train_acc: 0.9665443950154791, test_acc: 0.8768958609745311
Epoch 175 train_acc: 0.9654517547282707, test_acc: 0.8707562631702177
Epoch 180 train_acc: 0.9673508676084185, test_acc: 0.8784307604256094
Epoch 185 train_acc: 0.9673508676084185, test_acc: 0.8775462420978694
Epoch 190 train_acc: 0.9683654621608262, test_acc: 0.8761674341163922
Epoch 195 train_acc: 0.9658419834022738, test_acc: 0.8740081687869091
Epoch 200 train_acc: 0.9689377975493639, test_acc: 0.8744504279507792
Epoch 205 train_acc: 0.9661541663414761, test_acc: 0.8778324097921382
Epoch 210 train_acc: 0.9678451572621556, test_acc: 0.875126824319051
Epoch 215 train_acc: 0.9694060719581675, test_acc: 0.8742423059913109
Epoch 220 train_acc: 0.9687036603449621, test_acc: 0.8742423059913109
Epoch 225 train_acc: 0.9650875412992014, test_acc: 0.8747105804001145
Epoch 230 train_acc: 0.9688077213246963, test_acc: 0.8727854522750331
Epoch 235 train_acc: 0.9680792944665574, test_acc: 0.8734098181534379
Epoch 240 train_acc: 0.9679752334868232, test_acc: 0.8758032206873227
Epoch 245 train_acc: 0.9684435078956268, test_acc: 0.8771299981789329
Epoch 250 train_acc: 0.9680792944665574, test_acc: 0.877728348812404
Epoch 255 train_acc: 0.9682614011810922, test_acc: 0.8746845651551809
Epoch 260 train_acc: 0.9703166055308411, test_acc: 0.8746585499102474
Epoch 265 train_acc: 0.9693020109784334, test_acc: 0.8698717448424776
Epoch 270 train_acc: 0.9696662244075028, test_acc: 0.874736595645048
Epoch 275 train_acc: 0.9693800567132339, test_acc: 0.8724472540908973
Epoch 280 train_acc: 0.9695361481828352, test_acc: 0.8740341840318426
Epoch 285 train_acc: 0.9688337365696298, test_acc: 0.8745805041754469
Epoch 290 train_acc: 0.9704466817555087, test_acc: 0.8773901506282682
Epoch 295 train_acc: 0.9700044225916387, test_acc: 0.8752308852987851
Epoch 300 train_acc: 0.9700304378365723, test_acc: 0.8778324097921382
Epoch 305 train_acc: 0.9694060719581675, test_acc: 0.8742423059913109
Epoch 310 train_acc: 0.9696662244075028, test_acc: 0.8745284736855797
Epoch 315 train_acc: 0.9708629256744452, test_acc: 0.8774161658732017
Epoch 320 train_acc: 0.9699003616119046, test_acc: 0.8710684461094201
Epoch 325 train_acc: 0.968157340201358, test_acc: 0.8767137542599963
Epoch 330 train_acc: 0.9695621634277687, test_acc: 0.8711464918442207
Epoch 335 train_acc: 0.9707328494497776, test_acc: 0.8770259371991987
Epoch 340 train_acc: 0.9697963006321705, test_acc: 0.875569083482921
Epoch 345 train_acc: 0.9714612763079165, test_acc: 0.8759853274018575
Epoch 350 train_acc: 0.9695621634277687, test_acc: 0.8754910377481204
Epoch 355 train_acc: 0.970706834204844, test_acc: 0.867634433778194
Epoch 360 train_acc: 0.971097062878847, test_acc: 0.876063373136658
Epoch 365 train_acc: 0.9706808189599105, test_acc: 0.8759332969119904
Epoch 370 train_acc: 0.9679232029969562, test_acc: 0.8733317724186374
Epoch 375 train_acc: 0.9679752334868232, test_acc: 0.8724472540908973
Epoch 380 train_acc: 0.969484117692968, test_acc: 0.8661255495720492
Epoch 385 train_acc: 0.9699523921017716, test_acc: 0.8776503030776035
Epoch 390 train_acc: 0.9712791695933817, test_acc: 0.8759593121569239
Epoch 395 train_acc: 0.9721116574312547, test_acc: 0.8749967480943833
Epoch 400 train_acc: 0.9706027732251099, test_acc: 0.87762428783267
Epoch 405 train_acc: 0.9700824683264393, test_acc: 0.8737740315825073
Epoch 410 train_acc: 0.9708889409193787, test_acc: 0.8763235255859934
Epoch 415 train_acc: 0.971097062878847, test_acc: 0.8769478914643981
Epoch 420 train_acc: 0.9697182548973698, test_acc: 0.8697936991076771
Epoch 425 train_acc: 0.9704206665105752, test_acc: 0.8764796170555946
Epoch 430 train_acc: 0.9693020109784334, test_acc: 0.8721610863966284
Epoch 435 train_acc: 0.9687036603449621, test_acc: 0.8734098181534379
Epoch 440 train_acc: 0.9705767579801764, test_acc: 0.8717188272327584
Epoch 445 train_acc: 0.972319779390723, test_acc: 0.8748146413798485
Epoch 450 train_acc: 0.9695101329379016, test_acc: 0.8716928119878249
Epoch 455 train_acc: 0.9717474440021853, test_acc: 0.8728374827649003
Epoch 460 train_acc: 0.9707588646947111, test_acc: 0.8751528395639845
Epoch 465 train_acc: 0.97104503238898, test_acc: 0.8734358333983715
Epoch 470 train_acc: 0.9722157184109889, test_acc: 0.8733057571737038
Epoch 475 train_acc: 0.9704987122453758, test_acc: 0.8743463669710451
Epoch 480 train_acc: 0.9706808189599105, test_acc: 0.8717708577226254
Epoch 485 train_acc: 0.9694581024480345, test_acc: 0.8708863393948854
Epoch 490 train_acc: 0.9712791695933817, test_acc: 0.8728114675199667
Epoch 495 train_acc: 0.9675589895678868, test_acc: 0.8726813912952991
Epoch 500 train_acc: 0.9712271391035147, test_acc: 0.8715367205182237
Epoch 505 train_acc: 0.9718515049819194, test_acc: 0.8735659096230391
Epoch 510 train_acc: 0.9713312000832488, test_acc: 0.8759332969119904
Epoch 515 train_acc: 0.9704726970004423, test_acc: 0.8724212388459638
Epoch 520 train_acc: 0.9717474440021853, test_acc: 0.8723431931111632
Epoch 525 train_acc: 0.9687817060797628, test_acc: 0.8689872265147376
Epoch 530 train_acc: 0.9691719347537657, test_acc: 0.871848903457426
Epoch 535 train_acc: 0.9709930018991129, test_acc: 0.8714586747834231
Epoch 540 train_acc: 0.969432087203101, test_acc: 0.8716147662530243
Epoch 545 train_acc: 0.9677150810374879, test_acc: 0.8710684461094201
Epoch 550 train_acc: 0.9681833554462915, test_acc: 0.8710684461094201
Epoch 555 train_acc: 0.9706287884700434, test_acc: 0.8743983974609121
Epoch 560 train_acc: 0.97104503238898, test_acc: 0.8738260620723745
Epoch 565 train_acc: 0.9692499804885663, test_acc: 0.871354613803689
Epoch 570 train_acc: 0.969770285387237, test_acc: 0.8735919248679727
Epoch 575 train_acc: 0.970264575040974, test_acc: 0.8743983974609121
Epoch 580 train_acc: 0.9659720596269414, test_acc: 0.8708343089050183
Epoch 585 train_acc: 0.9699784073467052, test_acc: 0.8752048700538515
Epoch 590 train_acc: 0.970706834204844, test_acc: 0.872629360805432
Epoch 595 train_acc: 0.9708629256744452, test_acc: 0.8714586747834231
Epoch 600 train_acc: 0.9713312000832488, test_acc: 0.8739301230521085
Epoch 605 train_acc: 0.9703946512656416, test_acc: 0.8708603241499518
Epoch 610 train_acc: 0.970264575040974, test_acc: 0.87062618694555
Epoch 615 train_acc: 0.9713312000832488, test_acc: 0.8749447176045162
Epoch 620 train_acc: 0.968209370691225, test_acc: 0.8674263118187258
Epoch 625 train_acc: 0.9706808189599105, test_acc: 0.8721350711516949
Epoch 630 train_acc: 0.9712531543484482, test_acc: 0.8712505528239548
Epoch 635 train_acc: 0.9697442701423034, test_acc: 0.875178854808918
Epoch 640 train_acc: 0.9704987122453758, test_acc: 0.8716407814979578
Epoch 645 train_acc: 0.9715913525325841, test_acc: 0.8720570254168943
Epoch 650 train_acc: 0.9706027732251099, test_acc: 0.8683108301464658
Epoch 655 train_acc: 0.970212544551107, test_acc: 0.870522125965816
Epoch 660 train_acc: 0.9663622883009444, test_acc: 0.8677124795129946
Epoch 665 train_acc: 0.9696662244075028, test_acc: 0.8681027081869975
Epoch 670 train_acc: 0.968547568875361, test_acc: 0.8693254246988735
Epoch 675 train_acc: 0.9687296755898956, test_acc: 0.870574156455683
Epoch 680 train_acc: 0.968157340201358, test_acc: 0.87062618694555
Epoch 685 train_acc: 0.9703686360207081, test_acc: 0.8708082936600848
Epoch 690 train_acc: 0.9700824683264393, test_acc: 0.8712245375790213
Epoch 695 train_acc: 0.9707328494497776, test_acc: 0.8726813912952991
Epoch 700 train_acc: 0.9709930018991129, test_acc: 0.8724992845807643
Epoch 705 train_acc: 0.9709669866541794, test_acc: 0.8695595619032753
Epoch 710 train_acc: 0.9716954135123183, test_acc: 0.8729155284997008
Epoch 715 train_acc: 0.9669866541793491, test_acc: 0.8702619735164806
Epoch 720 train_acc: 0.9696141939176357, test_acc: 0.8682067691667317
Epoch 725 train_acc: 0.9710190171440464, test_acc: 0.8720830406618278
Epoch 730 train_acc: 0.9693800567132339, test_acc: 0.8707042326803507
Epoch 735 train_acc: 0.9688857670594969, test_acc: 0.8728114675199667
Epoch 740 train_acc: 0.9708629256744452, test_acc: 0.8734098181534379
Epoch 745 train_acc: 0.9690678737740316, test_acc: 0.8707562631702177
Epoch 750 train_acc: 0.9690158432841646, test_acc: 0.8707302479252842
Epoch 755 train_acc: 0.9691459195088322, test_acc: 0.8707822784151513
Epoch 760 train_acc: 0.9695881786727022, test_acc: 0.871796872967559
Epoch 765 train_acc: 0.970264575040974, test_acc: 0.8681807539217982
Epoch 770 train_acc: 0.9697442701423034, test_acc: 0.8728114675199667
Epoch 775 train_acc: 0.9693540414683004, test_acc: 0.8684148911262
Epoch 780 train_acc: 0.9659720596269414, test_acc: 0.8655011836936445
Epoch 785 train_acc: 0.9653997242384037, test_acc: 0.8706001717006165
Epoch 790 train_acc: 0.9713572153281823, test_acc: 0.8713025833138219
Epoch 795 train_acc: 0.9676110200577538, test_acc: 0.8679726319623299
Epoch 800 train_acc: 0.9694581024480345, test_acc: 0.868466921616067
Epoch 805 train_acc: 0.9672988371185515, test_acc: 0.86974166861781
Epoch 810 train_acc: 0.9682874164260257, test_acc: 0.8694034704336742
Epoch 815 train_acc: 0.9685735841202945, test_acc: 0.8728114675199667
Epoch 820 train_acc: 0.9688337365696298, test_acc: 0.8685969978407346
Epoch 825 train_acc: 0.9680792944665574, test_acc: 0.8626915372408231
Epoch 830 train_acc: 0.9657119071776061, test_acc: 0.8652670464892427
Epoch 835 train_acc: 0.9677931267722886, test_acc: 0.8678945862275294
Epoch 840 train_acc: 0.9655298004630714, test_acc: 0.8634980098337626
Epoch 845 train_acc: 0.9671427456489503, test_acc: 0.8711204765992872
Epoch 850 train_acc: 0.9683914774057598, test_acc: 0.8684929368610006
Epoch 855 train_acc: 0.9695621634277687, test_acc: 0.8702359582715471
Epoch 860 train_acc: 0.9668045474648144, test_acc: 0.8669320221649887
Epoch 865 train_acc: 0.9703166055308411, test_acc: 0.8714326595384896
Epoch 870 train_acc: 0.9679232029969562, test_acc: 0.8683888758812665
Epoch 875 train_acc: 0.9705247274903093, test_acc: 0.8729155284997008
Epoch 880 train_acc: 0.966934623689482, test_acc: 0.8669060069200551
Epoch 885 train_acc: 0.9686256146101615, test_acc: 0.8684929368610006
Epoch 890 train_acc: 0.9690418585290981, test_acc: 0.8674783423085929
Epoch 895 train_acc: 0.9677150810374879, test_acc: 0.8658393818777804
Epoch 900 train_acc: 0.9678191420172221, test_acc: 0.8694555009235412
Epoch 905 train_acc: 0.9679492182418897, test_acc: 0.8697676838627436
Epoch 910 train_acc: 0.968157340201358, test_acc: 0.8691693332292724
Epoch 915 train_acc: 0.9686256146101615, test_acc: 0.8681807539217982
Epoch 920 train_acc: 0.9690938890189651, test_acc: 0.8649288483051067
Epoch 925 train_acc: 0.970264575040974, test_acc: 0.8660735190821821
Epoch 930 train_acc: 0.967272821873618, test_acc: 0.8698717448424776
Epoch 935 train_acc: 0.9700564530815058, test_acc: 0.8671141288795234
Epoch 940 train_acc: 0.9704206665105752, test_acc: 0.8684929368610006
Epoch 945 train_acc: 0.9688337365696298, test_acc: 0.8703660344962147
Epoch 950 train_acc: 0.9648534040947996, test_acc: 0.8648247873253727
Epoch 955 train_acc: 0.9678971877520227, test_acc: 0.8670881136345898
Epoch 960 train_acc: 0.9657119071776061, test_acc: 0.8685969978407346
Epoch 965 train_acc: 0.9663362730560108, test_acc: 0.8710424308644866
Epoch 970 train_acc: 0.9648794193397331, test_acc: 0.8670881136345898
Epoch 975 train_acc: 0.9679492182418897, test_acc: 0.8735919248679727
Epoch 980 train_acc: 0.9661801815864096, test_acc: 0.8682327844116652
Epoch 985 train_acc: 0.9668305627097479, test_acc: 0.8663857020213845
Epoch 990 train_acc: 0.9682614011810922, test_acc: 0.8689612112698041
Epoch 995 train_acc: 0.9669606389344155, test_acc: 0.8692733942090065
Epoch 1000 train_acc: 0.9649314498296001, test_acc: 0.8593355706443976
